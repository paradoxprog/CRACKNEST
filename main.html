<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | CrackNest</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Poppins:wght@500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4F46E5', 
                        secondary: '#F59E0B', 
                        dark: '#0F172A', 
                        light: '#F8FAFC', 
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        heading: ['Poppins', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <style>
        .sidebar-link.active {
            background-color: #EEF2FF; 
            color: #4F46E5; 
            border-right: 3px solid #4F46E5;
        }
        .chat-scroll::-webkit-scrollbar { width: 6px; }
        .chat-scroll::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 4px; }
        
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4F46E5;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="font-sans text-slate-600 bg-slate-50 antialiased h-screen flex overflow-hidden">

    <aside class="w-64 bg-white border-r border-slate-200 flex-col hidden md:flex z-20">
        <div class="h-20 flex items-center px-6 border-b border-slate-100">
            <span class="font-heading font-bold text-2xl text-slate-800">Crack<span class="text-primary">Nest</span></span>
        </div>

        <nav class="flex-1 overflow-y-auto py-6 px-3 space-y-1">
            <button onclick="navTo('dashboard')" id="nav-dashboard" class="sidebar-link w-full text-left px-4 py-3 rounded-lg font-medium text-slate-600 hover:bg-slate-50 transition flex items-center gap-3">
                <i class="fa-solid fa-chart-pie w-6"></i> Dashboard
            </button>
            <button onclick="navTo('profile')" id="nav-profile" class="sidebar-link w-full text-left px-4 py-3 rounded-lg font-medium text-slate-600 hover:bg-slate-50 transition flex items-center gap-3">
                <i class="fa-solid fa-user-gear w-6"></i> Profile & Target
            </button>
            <button onclick="navTo('roadmap')" id="nav-roadmap" class="sidebar-link w-full text-left px-4 py-3 rounded-lg font-medium text-slate-600 hover:bg-slate-50 transition flex items-center gap-3">
                <i class="fa-solid fa-map w-6"></i> Personalized Plan
            </button>
            <button onclick="navTo('tests')" id="nav-tests" class="sidebar-link w-full text-left px-4 py-3 rounded-lg font-medium text-slate-600 hover:bg-slate-50 transition flex items-center gap-3">
                <i class="fa-solid fa-list-check w-6"></i> Test Series
            </button>
            <button onclick="navTo('interview')" id="nav-interview" class="sidebar-link w-full text-left px-4 py-3 rounded-lg font-medium text-slate-600 hover:bg-slate-50 transition flex items-center gap-3">
                <i class="fa-solid fa-robot w-6 text-purple-500"></i> AI Mock Interview
            </button>
            <button onclick="navTo('resume')" id="nav-resume" class="sidebar-link w-full text-left px-4 py-3 rounded-lg font-medium text-slate-600 hover:bg-slate-50 transition flex items-center gap-3">
                <i class="fa-solid fa-file-pen w-6"></i> Resume Builder
            </button>
        </nav>

        <div class="p-4 border-t border-slate-100">
            <div class="flex items-center gap-3 mb-4">
                <div class="w-10 h-10 rounded-full bg-primary text-white flex items-center justify-center font-bold" id="sidebar-avatar">U</div>
                <div>
                    <p class="text-sm font-bold text-slate-800" id="sidebar-name">User</p>
                    <p class="text-xs text-slate-400">Student</p>
                </div>
            </div>
            <button id="logout-btn" class="w-full border border-slate-200 text-slate-600 hover:text-red-500 hover:bg-red-50 px-4 py-2 rounded-lg text-sm font-medium transition">
                Sign Out
            </button>
        </div>
    </aside>

    <main class="flex-1 flex flex-col h-screen overflow-hidden relative">
        
        <div id="api-key-banner" class="bg-indigo-900 text-white px-6 py-2 text-xs flex justify-between items-center z-50 flex-shrink-0">
            <div class="flex items-center gap-2">
                <i class="fa-solid fa-key text-secondary"></i>
                <span class="font-bold">Gemini API Key Required:</span>
                <span class="opacity-80">Needed to generate your custom baseline test.</span>
            </div>
            <div class="flex gap-2">
                <input type="password" id="gemini-key-input" placeholder="Paste API Key here" class="text-slate-800 px-2 py-1 rounded text-xs w-48 border-none focus:ring-2 focus:ring-secondary">
                <button onclick="saveApiKey()" class="bg-secondary text-indigo-900 font-bold px-3 py-1 rounded hover:bg-amber-400 transition">Save Key</button>
            </div>
        </div>

        <div id="content-area" class="flex-1 overflow-y-auto p-4 md:p-8 relative">
            
            <section id="section-profile" class="max-w-4xl mx-auto hidden animate-fade-in">
                <div class="mb-8">
                    <h1 class="font-heading text-3xl font-bold text-slate-900">Personal Profile</h1>
                    <p class="text-slate-500">Complete your details to generate your customized baseline assessment.</p>
                </div>

                <form id="profile-form" class="space-y-6">
                    <div class="bg-white p-6 md:p-8 rounded-2xl shadow-sm border border-slate-100">
                        <h3 class="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2">
                            <i class="fa-solid fa-user text-primary"></i> Personal Info
                        </h3>
                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-1">Full Name</label>
                                <input type="text" id="p-name" required class="w-full px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-1">Degree / Stream</label>
                                <input type="text" id="p-degree" placeholder="e.g. B.Tech Computer Science" required class="w-full px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-1">Year of Passing</label>
                                <input type="number" id="p-year" placeholder="2025" required class="w-full px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-1">Languages Known</label>
                                <input type="text" id="p-langs" placeholder="e.g. English, Hindi, Spanish" class="w-full px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition">
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-slate-700 mb-1">Certifications</label>
                                <input type="text" id="p-certs" placeholder="e.g. AWS Cloud Practitioner, Google Data Analytics" class="w-full px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition">
                            </div>
                        </div>
                    </div>

                    <div class="bg-white p-6 md:p-8 rounded-2xl shadow-sm border border-slate-100">
                        <h3 class="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2">
                            <i class="fa-solid fa-bullseye text-secondary"></i> Career Target
                        </h3>
                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-1">Field</label>
                                <select id="p-field" class="w-full px-4 py-2 border border-slate-200 rounded-lg bg-white focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition">
                                    <option value="IT">Information Technology (IT)</option>
                                    <option value="Marketing">Marketing & Sales</option>
                                    <option value="Finance">Finance & Banking</option>
                                    <option value="HR">Human Resources</option>
                                    <option value="Engineering">Core Engineering</option>
                                    <option value="Design">Design (UI/UX)</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-1">Specific Role</label>
                                <input type="text" id="p-role" placeholder="e.g. Java Backend Developer" required class="w-full px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition">
                                <p class="text-xs text-slate-400 mt-1">This specific role will be used to generate your test.</p>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white p-6 md:p-8 rounded-2xl shadow-sm border border-slate-100">
                        <h3 class="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2">
                            <i class="fa-solid fa-briefcase text-slate-600"></i> Experience
                        </h3>
                        <div class="flex gap-4">
                            <label class="flex items-center gap-3 border border-slate-200 px-6 py-4 rounded-xl cursor-pointer hover:bg-indigo-50 hover:border-indigo-200 transition w-full group">
                                <input type="radio" name="exp" value="Fresher" checked class="w-5 h-5 text-primary focus:ring-primary">
                                <div>
                                    <span class="block font-bold text-slate-700 group-hover:text-primary">Fresher</span>
                                    <span class="text-xs text-slate-500">Student / Recent Grad</span>
                                </div>
                            </label>
                            <label class="flex items-center gap-3 border border-slate-200 px-6 py-4 rounded-xl cursor-pointer hover:bg-indigo-50 hover:border-indigo-200 transition w-full group">
                                <input type="radio" name="exp" value="Experienced" class="w-5 h-5 text-primary focus:ring-primary">
                                <div>
                                    <span class="block font-bold text-slate-700 group-hover:text-primary">Experienced</span>
                                    <span class="text-xs text-slate-500">Working Professional</span>
                                </div>
                            </label>
                        </div>
                    </div>

                    <button type="submit" class="w-full bg-slate-900 hover:bg-primary text-white font-bold py-4 rounded-xl shadow-xl transition transform hover:scale-[1.01] flex items-center justify-center gap-2">
                        Save Profile & Generate Test <i class="fa-solid fa-wand-magic-sparkles text-secondary"></i>
                    </button>
                </form>
            </section>

            <section id="section-loading" class="hidden h-full flex flex-col items-center justify-center text-center">
                <div class="loader mb-6"></div>
                <h2 class="text-2xl font-bold text-slate-800">Generating Your Skill Test...</h2>
                <p class="text-slate-500 max-w-md mt-2">Our AI is analyzing your profile to create specific questions for <span id="loading-role" class="font-bold text-primary">your role</span>.</p>
            </section>

            <section id="section-skilltest" class="max-w-3xl mx-auto hidden">
                <div class="text-center mb-8">
                    <span class="bg-indigo-50 text-primary px-3 py-1 rounded-full text-sm font-bold">Baseline Assessment</span>
                    <h2 class="font-heading text-3xl font-bold text-slate-900 mt-4">Skill Analysis</h2>
                    <p class="text-slate-500">Customized questions for <span id="test-role-display" class="font-bold text-slate-800">...</span></p>
                </div>

                <div class="bg-white rounded-2xl shadow-xl overflow-hidden border border-slate-100">
                    <div class="bg-slate-50 px-8 py-4 border-b border-slate-100 flex justify-between items-center">
                        <span class="font-bold text-slate-700">Question <span id="q-number">1</span>/<span id="q-total">5</span></span>
                        <div class="flex gap-1" id="q-dots">
                            </div>
                    </div>
                    
                    <div class="p-8">
                        <p id="q-text" class="text-lg font-medium text-slate-800 mb-6">Loading question...</p>
                        
                        <div id="q-options" class="space-y-3">
                            </div>
                    </div>
                </div>
            </section>

            <section id="section-dashboard" class="hidden space-y-8">
                <div class="bg-gradient-to-r from-primary to-purple-600 rounded-2xl p-8 text-white shadow-lg relative overflow-hidden">
                    <div class="relative z-10">
                        <h1 class="font-heading text-3xl font-bold mb-2">Welcome back, <span id="dash-name">User</span>!</h1>
                        <p class="text-indigo-100 mb-6 max-w-xl">Based on your baseline test, we have prepared your readiness report.</p>
                        <div class="flex gap-4">
                            <button onclick="navTo('roadmap')" class="bg-white text-primary px-6 py-2.5 rounded-lg font-bold hover:bg-indigo-50 transition shadow-lg">View Roadmap</button>
                            <button onclick="navTo('interview')" class="bg-indigo-500/30 border border-white/20 text-white px-6 py-2.5 rounded-lg font-bold hover:bg-indigo-500/40 transition">Mock Interview</button>
                        </div>
                    </div>
                    <i class="fa-solid fa-trophy absolute -bottom-4 -right-4 text-9xl text-white/10 rotate-12"></i>
                </div>

                <div id="test-result-card" class="bg-white p-6 rounded-xl border border-slate-100 shadow-sm">
                    <h3 class="font-bold text-slate-800 mb-4">Baseline Test Result</h3>
                    <div class="flex items-center gap-6">
                        <div class="w-24 h-24 rounded-full border-8 border-primary/20 flex items-center justify-center relative">
                            <span class="text-2xl font-bold text-primary" id="score-display">0%</span>
                            <div class="absolute inset-0 rounded-full border-8 border-primary border-t-transparent animate-[spin_1s_linear_reverse]" style="clip-path: polygon(0 0, 100% 0, 100% 50%, 0 50%);"></div>
                        </div>
                        <div>
                            <p class="text-slate-600 mb-1">Target Role: <span id="result-role" class="font-bold">...</span></p>
                            <p class="text-sm text-slate-500">AI Recommendation: <span class="text-green-600 font-bold">Focus on Data Structures</span></p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="section-interview" class="hidden h-full flex flex-col">
                <div class="mb-4 flex justify-between items-center">
                    <h2 class="font-heading text-2xl font-bold text-slate-900">AI Mock Interview</h2>
                    <button onclick="startInterview()" class="bg-primary text-white px-4 py-1.5 rounded-lg text-sm font-bold">New Session</button>
                </div>
                <div class="flex-1 bg-white rounded-2xl border border-slate-200 shadow-sm flex flex-col overflow-hidden">
                    <div id="chat-history" class="flex-1 overflow-y-auto p-6 space-y-4 bg-slate-50/50 chat-scroll"></div>
                    <div class="p-4 bg-white border-t border-slate-100 relative">
                        <textarea id="chat-input" rows="2" class="w-full bg-slate-50 border border-slate-200 rounded-xl pl-4 pr-12 py-3 focus:outline-none focus:ring-2 focus:ring-primary/20 resize-none" placeholder="Type answer..."></textarea>
                        <button onclick="sendChatMessage()" class="absolute right-3 top-3 w-8 h-8 bg-primary text-white rounded-lg flex items-center justify-center"><i class="fa-solid fa-paper-plane text-xs"></i></button>
                    </div>
                </div>
            </section>

            <section id="section-resume" class="hidden max-w-4xl mx-auto">
                 <div class="mb-6"><h2 class="font-heading text-2xl font-bold text-slate-900">Resume Builder</h2></div>
                 <div class="bg-white p-6 rounded-xl border border-slate-100 shadow-sm">
                     <p>Resume features are available after completing the baseline test.</p>
                 </div>
            </section>

            <section id="section-roadmap" class="hidden"><div class="text-center py-20"><h2 class="text-2xl font-bold">Roadmap</h2></div></section>
            <section id="section-tests" class="hidden"><div class="text-center py-20"><h2 class="text-2xl font-bold">Test Series</h2></div></section>
        </div>
    </main>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        const firebaseConfig = { apiKey: "AIzaSyAGK_7tNXEyBCUjV9wqBDlbXmbpNxaH2mU", authDomain: "crak-a74d0.firebaseapp.com", projectId: "crak-a74d0", storageBucket: "crak-a74d0.firebasestorage.app", messagingSenderId: "106356918520", appId: "1:106356918520:web:e9affa0adef64574c1530d", measurementId: "G-YFG4XZWP68" };
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById('sidebar-name').innerText = user.displayName || user.email.split('@')[0];
                document.getElementById('sidebar-avatar').innerText = (user.email[0]).toUpperCase();
            } else { window.location.href = "index.html"; }
        });
        document.getElementById('logout-btn').addEventListener('click', () => { signOut(auth).then(() => window.location.href = "index.html"); });
    </script>

    <script>
        let currentState = { view: 'profile', userProfile: {}, apiKey: '', chatHistory: [], generatedQuestions: [], score: 0 };

        function navTo(sectionId) {
            document.querySelectorAll('section').forEach(sec => sec.classList.add('hidden'));
            document.querySelectorAll('.sidebar-link').forEach(link => link.classList.remove('active'));
            document.getElementById('section-' + sectionId).classList.remove('hidden');
            const navLink = document.getElementById('nav-' + sectionId);
            if(navLink) navLink.classList.add('active');
            currentState.view = sectionId;
        }

        // --- API KEY HANDLING ---
        function saveApiKey() {
            const key = document.getElementById('gemini-key-input').value;
            if(key) {
                currentState.apiKey = key;
                document.getElementById('api-key-banner').classList.add('hidden');
                alert("API Key Saved!");
            }
        }

        async function callGemini(prompt) {
            if (!currentState.apiKey) {
                alert("Please enter a Gemini API Key in the top banner.");
                throw new Error("No API Key");
            }
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${currentState.apiKey}`;
            const response = await fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
            });
            const data = await response.json();
            return data.candidates[0].content.parts[0].text;
        }

        // --- PROFILE & TEST GENERATION ---
        document.getElementById('profile-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // 1. Capture Data
            currentState.userProfile = {
                name: document.getElementById('p-name').value,
                degree: document.getElementById('p-degree').value,
                year: document.getElementById('p-year').value,
                certs: document.getElementById('p-certs').value,
                langs: document.getElementById('p-langs').value,
                field: document.getElementById('p-field').value,
                role: document.getElementById('p-role').value,
                exp: document.querySelector('input[name="exp"]:checked').value
            };

            // Update UI Names
            document.getElementById('dash-name').innerText = currentState.userProfile.name;
            document.getElementById('loading-role').innerText = currentState.userProfile.role;
            document.getElementById('test-role-display').innerText = currentState.userProfile.role;
            document.getElementById('result-role').innerText = currentState.userProfile.role;

            // 2. Show Loading
            document.getElementById('section-profile').classList.add('hidden');
            document.getElementById('section-loading').classList.remove('hidden');

            // 3. Generate Test via AI
            try {
                const prompt = `Generate 5 multiple choice interview questions for a candidate applying for a "${currentState.userProfile.role}" role in the field of "${currentState.userProfile.field}". The candidate is a "${currentState.userProfile.exp}". 
                
                IMPORTANT: Return ONLY valid JSON array. No markdown, no code blocks.
                Format: [{"q": "Question text", "options": ["A", "B", "C", "D"], "answer": 0}] (where answer is the index of the correct option 0-3).`;

                const rawData = await callGemini(prompt);
                
                // Clean AI response (remove markdown if present)
                const cleanJson = rawData.replace(/```json/g, '').replace(/```/g, '').trim();
                currentState.generatedQuestions = JSON.parse(cleanJson);

                // 4. Start Test
                document.getElementById('section-loading').classList.add('hidden');
                navTo('skilltest');
                startTest();

            } catch (error) {
                console.error(error);
                alert("Failed to generate test. Ensure API Key is correct.");
                document.getElementById('section-loading').classList.add('hidden');
                document.getElementById('section-profile').classList.remove('hidden');
            }
        });

        // --- TEST LOGIC ---
        let currentQIndex = 0;
        let userScore = 0;

        function startTest() {
            currentQIndex = 0;
            userScore = 0;
            document.getElementById('q-total').innerText = currentState.generatedQuestions.length;
            renderQuestion();
        }

        function renderQuestion() {
            if(currentQIndex >= currentState.generatedQuestions.length) {
                finishTest();
                return;
            }

            const q = currentState.generatedQuestions[currentQIndex];
            document.getElementById('q-number').innerText = currentQIndex + 1;
            document.getElementById('q-text').innerText = q.q;

            // Dots
            const dotsContainer = document.getElementById('q-dots');
            dotsContainer.innerHTML = '';
            currentState.generatedQuestions.forEach((_, idx) => {
                const dot = document.createElement('div');
                dot.className = `w-2 h-2 rounded-full ${idx === currentQIndex ? 'bg-primary' : 'bg-slate-300'}`;
                dotsContainer.appendChild(dot);
            });

            // Options
            const optsContainer = document.getElementById('q-options');
            optsContainer.innerHTML = '';
            q.options.forEach((opt, idx) => {
                const btn = document.createElement('button');
                btn.className = "w-full text-left p-4 rounded-lg border border-slate-200 hover:border-primary hover:bg-indigo-50 transition text-slate-700 font-medium";
                btn.innerText = opt;
                btn.onclick = () => selectOption(idx, q.answer);
                optsContainer.appendChild(btn);
            });
        }

        function selectOption(selectedIdx, correctIdx) {
            if(selectedIdx === correctIdx) userScore++;
            currentQIndex++;
            renderQuestion(); // Immediately go to next
        }

        function finishTest() {
            navTo('dashboard');
            const percentage = Math.round((userScore / currentState.generatedQuestions.length) * 100);
            document.getElementById('score-display').innerText = percentage + '%';
        }

        // --- MOCK INTERVIEW LOGIC (Basic) ---
        function startInterview() {
            document.getElementById('chat-history').innerHTML = ''; 
            currentState.chatHistory = [];
            const msg = `Hello ${currentState.userProfile.name}, I see you are applying for a ${currentState.userProfile.role} role. Let's start.`;
            appendChat('ai', msg);
            currentState.chatHistory.push(`AI: ${msg}`);
        }

        async function sendChatMessage() {
            const input = document.getElementById('chat-input');
            const text = input.value.trim();
            if(!text) return;
            
            appendChat('user', text);
            input.value = '';
            currentState.chatHistory.push(`User: ${text}`);

            const context = currentState.chatHistory.slice(-6).join('\n');
            const prompt = `${context}\n\nAct as a ${currentState.userProfile.role} interviewer. Respond to the user's answer and ask the next relevant technical question. Keep it short.`;
            
            const reply = await callGemini(prompt);
            appendChat('ai', reply);
            currentState.chatHistory.push(`AI: ${reply}`);
        }

        function appendChat(sender, text) {
            const div = document.createElement('div');
            div.className = `flex items-start gap-3 ${sender === 'user' ? 'flex-row-reverse' : ''}`;
            const bg = sender === 'ai' ? 'bg-white border border-slate-200' : 'bg-primary text-white';
            div.innerHTML = `<div class="p-3 rounded-2xl ${bg} max-w-[80%] text-sm">${marked.parse(text)}</div>`;
            document.getElementById('chat-history').appendChild(div);
        }
    </script>
</body>
</html>
